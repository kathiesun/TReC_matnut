pmat_df %>% arrange(desc(het_stat)) %>% filter(het_padj_fdr < 0.05)
pmat_sig = pmat_df %>% arrange(desc(het_stat)) %>% filter(het_padj_fdr < 0.05)
genes = rownames(pmat_sig)
write.csv(pmat_sig, file.path(dir, "trec/priority_deseq_genes_2feb2021.csv"),row.names = F, quote = F)
dim(pmat_sig)
keep_genes = genes
keep_genes
i=1
geneUse = keep_genes[i]        #sig_genes_short[[1]][3]
geneResDf_list[[geneUse]] = list()
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts$Pup.ID = as.numeric(unlist(strsplit(rownames(plotCts),"_"))[c(F,T)])
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID")
head(plotCts)
head(plotCts)
plotCts
sdfds
1+1
plotCts
dim(plotCts)
genes
length(keep_genes)
geneUse = keep_genes[i]        #sig_genes_short[[1]][3]
geneResDf_list[[geneUse]] = list()
geneUse
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts
names(dds_list)
#saveRDS(dds_list, file.path(dir,"de_results/dds_list_allReg_sepRIX_30jan2021.rds"))
dds_list = readRDS(file.path(dir,"de_results/dds_list_allReg_sepRIX_30jan2021.rds"))
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts$Pup.ID = as.numeric(unlist(strsplit(rownames(plotCts),"_"))[c(F,T)])
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID")
plotCts
names(dds_list)
x=dds_list
x=dds_list[[1]]
geneUse %in% rownames(x)
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
library(DESeq2)
geneUse
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts$Pup.ID = as.numeric(unlist(strsplit(rownames(plotCts),"_"))[c(F,T)])
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID")
plotCts
which_homs_list[[geneUse]]
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-"CCs") %>%
left_join(which_homs_list[[geneUse]], by="RIX")
head(plotCts)
geneUse
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-"CCs") %>%
left_join(which_homs_list[[geneUse]], by="RIX")
plotCts
head(plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-"CCs") %>%
left_join(which_homs_list[[geneUse]], by="RIX"))
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-one_of("CCs")) %>%
left_join(which_homs_list[[geneUse]], by="RIX")
head(plotCts)
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts$Pup.ID = as.numeric(unlist(strsplit(rownames(plotCts),"_"))[c(F,T)])
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-one_of("CCs")) %>%
left_join(which_homs_list[[geneUse]], by="RIX")
head(plotCts)
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_point(position = position_jitter(width = 0.15)) +
theme_classic() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_point(position = position_jitter(width = 0.15)) +
geom_rect(aes(fill = hom_tot), xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha = 0.2) +
theme_classic() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
geneResDf_list[[geneUse]]$plot = ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_point(position = position_jitter(width = 0.15)) +
geom_rect(aes(fill = hom_tot), xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha = 0.01) +
theme_classic() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(aes(fill = hom_tot), xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha = 0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_classic() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot), xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha = 0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_classic() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot), xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha = 0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot), xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha = 0.1, col="gray") +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot, col="gray", alpha = 0.1),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf, color="gray", alpha=0.1,
ymin = -Inf, ymax = Inf) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
color="gray", alpha=0.01,
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
geneResDf_list[[geneUse]]$plot = ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey() +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
geneResDf_list[[geneUse]]$plot
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey() +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey(alpha=0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey() + scale_alpha_manual(alpha=0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey() + scale_alpha_manual(alpha=0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_manual(alpha=0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_manual(0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_manual(values = 0.01) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_discrete(values = 0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_discrete(values = 0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_discrete() +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey() + scale_alpha_discrete(0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_grey() + scale_alpha_manual(values=0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_manual(values = alpha(c("gray"), .01)) +
#scale_fill_grey() + scale_alpha_manual(values=0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_manual(values = alpha(c("gray","gray"), .01)) +
#scale_fill_grey() + scale_alpha_manual(values=0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf) +
scale_fill_manual(values = alpha(c("gray","gray"), c(.01, 0.01))) +
#scale_fill_grey() + scale_alpha_manual(values=0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
subset(plotCts, hom_tot == T)
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=rep(0.01, 2)) +
scale_fill_grey() + scale_alpha_manual(0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=rep(0.01, 2)) +
scale_fill_grey() + scale_alpha_manual(0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
rep(0.01, 2)
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=rep(0.01, 2)) +
scale_fill_grey()
ggplot(plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() + scale_alpha_manual(0.001) +
geom_point(position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
dev.off()
ggplot(aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot(aes(x=DamLine_NewCC_ID, y=count, col=Diet)) +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey()
ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot() +
annotate(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot() +
annotate("rect", data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
plotCts = data.frame(plotCts)
ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -1, xmax = 1,
ymin = -1, ymax = 1, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
#xmin = -1, xmax = 1,
#ymin = -1, ymax = 1,
alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
#xmin = -1, xmax = 1,
#ymin = -1, ymax = 1,
alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
geneResDf_list = list()
for(i in 1:length(keep_genes)){
geneUse = keep_genes[i]        #sig_genes_short[[1]][3]
geneResDf_list[[geneUse]] = list()
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts$Pup.ID = as.numeric(unlist(strsplit(rownames(plotCts),"_"))[c(F,T)])
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-one_of("CCs")) %>%
left_join(which_homs_list[[geneUse]], by="RIX")
plotCts = data.frame(plotCts)
geneResDf_list[[geneUse]]$plot = ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
geneResDf = data.frame(do.call("rbind", lapply(POres_list, function(x) x[which(rownames(x) == geneUse),])))
geneResDf$gene = rownames(geneResDf)[1]
geneResDf$rix = names(POres_list)
rownames(geneResDf) = NULL
#dfTitle = unlist(lapply(POres_list, function(x) unlist(strsplit(x@elementMetadata$description[2],":",))[c(F,T)]))
#rownames(geneResDf) = gsub(" ","",dfTitle)
geneResDf_list[[geneUse]]$df = geneResDf
}
geneResDf_list[["Meg3"]]$plot
length(geneResDf_list)
geneResDf_list = list()
for(i in 1:length(keep_genes)){
geneUse = keep_genes[i]        #sig_genes_short[[1]][3]
geneResDf_list[[geneUse]] = list()
plotCts = do.call("rbind", lapply(dds_list, function(x)
if(geneUse %in% rownames(x)){
plotCounts(x, gene=geneUse, intgroup=c("PO","RIX","Diet"), returnData = T)
}))
plotCts$Pup.ID = as.numeric(unlist(strsplit(rownames(plotCts),"_"))[c(F,T)])
plotCts = plotCts %>% left_join(lab[,-which(colnames(lab) %in% c("RIX", "Reciprocal", "Diet"))], by="Pup.ID") %>%
select(-one_of("CCs")) %>%
left_join(which_homs_list[[geneUse]], by="RIX")
plotCts = data.frame(plotCts)
geneResDf_list[[geneUse]]$plot = ggplot() +
geom_rect(data=subset(plotCts, hom_tot == T), aes(fill = hom_tot),
xmin = -Inf, xmax = Inf,
ymin = -Inf, ymax = Inf, alpha=0.01) +
scale_fill_grey() +
geom_point(data=plotCts, aes(x=DamLine_NewCC_ID, y=count, col=Diet),
position = position_jitter(width = 0.15)) +
theme_bw() +
ggtitle(geneUse) +
facet_wrap(~CCs, scales="free_x")
geneResDf = data.frame(do.call("rbind", lapply(POres_list, function(x) x[which(rownames(x) == geneUse),])))
geneResDf$gene = rownames(geneResDf)[1]
geneResDf$rix = names(POres_list)
rownames(geneResDf) = NULL
#dfTitle = unlist(lapply(POres_list, function(x) unlist(strsplit(x@elementMetadata$description[2],":",))[c(F,T)]))
#rownames(geneResDf) = gsub(" ","",dfTitle)
geneResDf_list[[geneUse]]$df = geneResDf
}
length(geneResDf_list)
1:length(keep_genes)
geneUse
